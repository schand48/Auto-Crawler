#Testing on a single page 
from bs4 import BeautifulSoup   
import requests 
import pandas as pd     

#Source of scraping
website = 'https://www.cars.com/shopping/results/?page=1&page_size=20&list_price_max=&makes[]=honda&maximum_distance=50&models[]=&stock_type=all&zip=95355'

#Requesting using requests lib 
response = requests.get(website)

soup = BeautifulSoup(response.content, 'html.parser')
 #Finding results 
results = soup.find_all('div', {'class':'vehicle-card'})

#### Filters: Name, Miles, Price in a For loop
name = []
price = []
for result in results:
    # name
    try:
        name.append(result.find('h2').get_text()) 
    except:
        name.append('n/a')
    #price 
    try:
        price.append(result.find('span', {'class':'primary-price'}).get_text())
    except:
        price.append('n/a')
#Using Pandas to create a dictionary and import to Excel

car_listings = pd.DataFrame({'Name': name, 'Price': price})
car_listings.to_excel('car_listings_page.xlsx')
